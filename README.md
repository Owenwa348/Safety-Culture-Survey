# Safety Culture Survey Platform üõ°Ô∏è

**‡πÅ‡∏û‡∏•‡∏ï‡∏ü‡∏≠‡∏£‡πå‡∏°‡πÅ‡∏ö‡∏ö‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏ß‡∏±‡∏í‡∏ô‡∏ò‡∏£‡∏£‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢‡∏†‡∏≤‡∏¢‡πÉ‡∏ô‡∏≠‡∏á‡∏Ñ‡πå‡∏Å‡∏£**

‡∏£‡∏∞‡∏ö‡∏ö‡∏ö‡∏£‡∏¥‡∏´‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡πÅ‡∏•‡∏∞‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡πÅ‡∏ö‡∏ö‡∏™‡∏≠‡∏ö‡∏ñ‡∏≤‡∏°‡∏ß‡∏±‡∏í‡∏ô‡∏ò‡∏£‡∏£‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢‡∏≠‡∏á‡∏Ñ‡πå‡∏Å‡∏£ (Safety Culture Maturity Survey) ‡πÅ‡∏ö‡∏ö‡∏Ñ‡∏£‡∏ö‡∏ß‡∏á‡∏à‡∏£ ‡∏û‡∏±‡∏í‡∏ô‡∏≤‡∏î‡πâ‡∏ß‡∏¢ **Node.js**, **Express**, **Vue 3**, **Prisma ORM** ‡πÅ‡∏•‡∏∞ **MySQL** ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡πÅ‡∏ö‡∏ö 3 ‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô (User/Admin/SuperAdmin) ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏£‡∏∞‡∏ö‡∏ö‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÅ‡∏•‡∏∞‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡πÅ‡∏ö‡∏ö real-time

---

## üìã ‡∏™‡∏≤‡∏£‡∏ö‡∏±‡∏ç

1. [‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡∏Ñ](#‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡∏Ñ)
2. [‡∏™‡∏ñ‡∏≤‡∏õ‡∏±‡∏ï‡∏¢‡∏Å‡∏£‡∏£‡∏°‡∏£‡∏∞‡∏ö‡∏ö](#‡∏™‡∏ñ‡∏≤‡∏õ‡∏±‡∏ï‡∏¢‡∏Å‡∏£‡∏£‡∏°‡∏£‡∏∞‡∏ö‡∏ö)
3. [‡πÄ‡∏ó‡∏Ñ‡πÇ‡∏ô‡πÇ‡∏•‡∏¢‡∏µ‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ](#‡πÄ‡∏ó‡∏Ñ‡πÇ‡∏ô‡πÇ‡∏•‡∏¢‡∏µ‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ)
4. [‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•](#‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•)
5. [API Endpoints](#api-endpoints)
6. [Business Logic](#business-logic)
7. [Authentication & Authorization](#authentication--authorization)
8. [Frontend Architecture](#frontend-architecture)
9. [Analytics & Reporting](#analytics--reporting)
10. [‡∏Å‡∏≤‡∏£‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á‡πÅ‡∏•‡∏∞‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô](#‡∏Å‡∏≤‡∏£‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á‡πÅ‡∏•‡∏∞‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô)
11. [Docker Deployment](#docker-deployment)
12. [Security Considerations](#security-considerations)

---

## ‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡∏Ñ

### ‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏õ‡∏£‡∏∞‡∏™‡∏á‡∏Ñ‡πå
‡∏£‡∏∞‡∏ö‡∏ö‡∏ô‡∏µ‡πâ‡∏ñ‡∏π‡∏Å‡∏û‡∏±‡∏í‡∏ô‡∏≤‡∏Ç‡∏∂‡πâ‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠:
- **‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏ß‡∏±‡∏í‡∏ô‡∏ò‡∏£‡∏£‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢** ‡∏†‡∏≤‡∏¢‡πÉ‡∏ô‡∏≠‡∏á‡∏Ñ‡πå‡∏Å‡∏£‡πÅ‡∏ö‡∏ö structured survey
- **‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•** ‡πÅ‡∏ö‡∏ö‡πÅ‡∏ö‡πà‡∏á‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏ï‡∏≤‡∏° Department, Position, WorkGroup, Experience
- **‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏Å‡∏£‡∏≤‡∏ü** ‡πÅ‡∏ö‡∏ö real-time (Horizontal Bar Chart, Stacked Bar Chart)
- **‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô** ‡πÅ‡∏ö‡∏ö multi-company ‡πÅ‡∏•‡∏∞ multi-role
- **Seed ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á** ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö testing ‡πÅ‡∏•‡∏∞ demo

### ‡∏Ñ‡∏∏‡∏ì‡∏™‡∏°‡∏ö‡∏±‡∏ï‡∏¥‡∏´‡∏•‡∏±‡∏Å
‚úÖ **3-Tier Authentication**: User (Evaluator) / Admin / SuperAdmin  
‚úÖ **Survey System**: ‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡πÅ‡∏ö‡∏ö 1-5 rating scale (Current vs Future)  
‚úÖ **Excel Import**: ‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏à‡∏≤‡∏Å‡πÑ‡∏ü‡∏•‡πå Excel  
‚úÖ **Master Data Management**: ‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà, ‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°, ‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏∑‡∏≠‡∏Å, ‡πÅ‡∏ú‡∏ô‡∏Å, ‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á  
‚úÖ **Analytics Dashboard**: ‡∏Å‡∏£‡∏≤‡∏ü‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡πÅ‡∏¢‡∏Å‡∏ï‡∏≤‡∏°‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó, ‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á, ‡πÅ‡∏ú‡∏ô‡∏Å  
‚úÖ **Docker Support**: ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡∏ó‡∏±‡πâ‡∏á Development (hot reload) ‡πÅ‡∏•‡∏∞ Production  
‚úÖ **Responsive Design**: ‡πÉ‡∏ä‡πâ Tailwind CSS ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡∏ó‡∏∏‡∏Å‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå  

---

## ‡∏™‡∏ñ‡∏≤‡∏õ‡∏±‡∏ï‡∏¢‡∏Å‡∏£‡∏£‡∏°‡∏£‡∏∞‡∏ö‡∏ö

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê      ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê      ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ   Frontend      ‚îÇ‚óÑ‚îÄ‚îÄ‚îÄ‚îÄ‚ñ∫‚îÇ    Backend       ‚îÇ‚óÑ‚îÄ‚îÄ‚îÄ‚îÄ‚ñ∫‚îÇ   MySQL DB      ‚îÇ
‚îÇ   Vue 3 + Vite  ‚îÇ HTTP ‚îÇ  Express + Node  ‚îÇ ORM  ‚îÇ   Prisma        ‚îÇ
‚îÇ   Port 5173     ‚îÇ      ‚îÇ  Port 5000       ‚îÇ      ‚îÇ   Port 3307     ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò      ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò      ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
        ‚îÇ                         ‚îÇ
        ‚îÇ                         ‚îú‚îÄ‚îÄ‚ñ∫ bcryptjs (Password Hashing)
        ‚îÇ                         ‚îú‚îÄ‚îÄ‚ñ∫ CORS (Multi-origin support)
        ‚îÇ                         ‚îî‚îÄ‚îÄ‚ñ∫ Multer (Excel Upload)
        ‚îÇ
        ‚îú‚îÄ‚îÄ‚ñ∫ Vue Router (Navigation)
        ‚îú‚îÄ‚îÄ‚ñ∫ Axios (HTTP Client)
        ‚îú‚îÄ‚îÄ‚ñ∫ Chart.js (Data Visualization)
        ‚îî‚îÄ‚îÄ‚ñ∫ Pinia (State Management)
```

### Architecture Pattern
- **3-Tier Architecture**: Frontend / Backend API / Database
- **RESTful API**: Stateless HTTP endpoints
- **MVC Pattern**: Controller-based routing
- **ORM**: Prisma Client ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö database operations

---

## ‡πÄ‡∏ó‡∏Ñ‡πÇ‡∏ô‡πÇ‡∏•‡∏¢‡∏µ‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ

### Backend Stack
| Technology | Version | Purpose |
|------------|---------|---------|
| Node.js | 20 Alpine | JavaScript runtime |
| Express.js | 5.1.0 | Web framework |
| Prisma ORM | 6.16.3 | Database ORM |
| MySQL | 8.0 | Relational database |
| bcryptjs | 3.0.2 | Password hashing |
| cors | 2.8.5 | Cross-origin resource sharing |
| multer | 1.4.5-lts.1 | File upload middleware |
| exceljs | 4.4.0 | Excel file parsing |

### Frontend Stack
| Technology | Version | Purpose |
|------------|---------|---------|
| Vue.js | 3.5.18 | Progressive JavaScript framework |
| Vite | 7.1.2 | Build tool & dev server |
| TypeScript | 5.8.3 | Type safety |
| Vue Router | 4.5.1 | Client-side routing |
| Pinia | 3.0.3 | State management |
| Axios | 1.12.2 | HTTP client |
| Chart.js | 4.5.0 | Data visualization |
| Tailwind CSS | 4.1.13 | Utility-first CSS |

### DevOps
- **Docker** + **Docker Compose** (containerization)
- **Nginx** (production web server)
- **nodemon** (development hot reload)
- **Vite HMR** (frontend hot module replacement)

---

## ‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•

### Database Schema (15 Models)

#### 1. **Authentication Models**

##### `user_excel`
‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡∏°‡∏µ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏£‡∏∞‡∏ö‡∏ö (‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡∏à‡∏≤‡∏Å Excel)
```prisma
model user_excel {
  id             Int      @id @default(autoincrement())
  email_user     String   @unique
  company_user   String
  division_user  String?
  createdAt      DateTime @default(now())
}
```

##### `User`
‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡πÅ‡∏•‡πâ‡∏ß (Evaluator)
```prisma
model User {
  id                Int      @id @default(autoincrement())
  title_user        String?
  name_user         String
  email_user        String   @unique
  company_user      String
  phone_user        String?
  password_user     String?
  position_user     String?
  job_field_user    String?   // ‡πÅ‡∏ú‡∏ô‡∏Å/‡∏™‡∏≤‡∏¢‡∏á‡∏≤‡∏ô
  work_group_user   String?   // ‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏á‡∏≤‡∏ô
  years_of_service  String?   // ‡∏õ‡∏£‡∏∞‡∏™‡∏ö‡∏Å‡∏≤‡∏£‡∏ì‡πå
  section_user      String?   // ‡∏ù‡πà‡∏≤‡∏¢/‡πÅ‡∏ú‡∏ô‡∏Å‡∏¢‡πà‡∏≠‡∏¢
  role_user         String   @default("user")
  status            String   @default("registered")  // registered, active, inactive
  surveyStatus      String   @default("not_started") // not_started, in_progress, done
  createdAt         DateTime @default(now())
  updatedAt         DateTime @updatedAt
  surveyAnswers     SurveyAnswer[]
}
```

##### `AdminList`
‡∏ú‡∏π‡πâ‡∏î‡∏π‡πÅ‡∏•‡∏£‡∏∞‡∏ö‡∏ö‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó
```prisma
model AdminList {
  id          Int       @id @default(autoincrement())
  email       String    @unique
  companyName String
  firstName   String?
  lastName    String?
  phone       String?
  password    String?   // bcrypt hashed
  role        String    @default("Admin")
  status      String    @default("PENDING")  // PENDING, ACTIVE
  joinedAt    DateTime?
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
}
```

##### `SuperAdminList`
‡∏ú‡∏π‡πâ‡∏î‡∏π‡πÅ‡∏•‡∏£‡∏∞‡∏ö‡∏ö‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î
```prisma
model SuperAdminList {
  id        Int       @id @default(autoincrement())
  email     String    @unique
  phone     String?   @unique
  pin       String?   // 6-digit PIN (bcrypt hashed)
  password  String?   // bcrypt hashed
  role      String    @default("Super Admin")
  status    String    @default("PENDING")  // PENDING, ACTIVE
  lastLogin DateTime?
  createdAt DateTime  @default(now())
  updatedAt DateTime  @updatedAt
}
```

#### 2. **Master Data Models**

##### `Department`
‡∏™‡∏≤‡∏¢‡∏á‡∏≤‡∏ô/‡πÅ‡∏ú‡∏ô‡∏Å‡∏´‡∏•‡∏±‡∏Å (‡πÄ‡∏ä‡πà‡∏ô CEO, REP, COO, CFO, SSE, PSE, CME)
```prisma
model Department {
  id        Int      @id @default(autoincrement())
  name      String
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}
```

##### `Experience`
‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏õ‡∏£‡∏∞‡∏™‡∏ö‡∏Å‡∏≤‡∏£‡∏ì‡πå‡∏ó‡∏≥‡∏á‡∏≤‡∏ô (‡πÄ‡∏ä‡πà‡∏ô 0-3 ‡∏õ‡∏µ, 3-5 ‡∏õ‡∏µ, 5-10 ‡∏õ‡∏µ, 10-15 ‡∏õ‡∏µ, 15+ ‡∏õ‡∏µ)
```prisma
model Experience {
  id        Int      @id @default(autoincrement())
  name      String
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}
```

##### `Position`
‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏á‡∏≤‡∏ô (‡πÄ‡∏ä‡πà‡∏ô ‡∏ú‡∏π‡πâ‡∏ö‡∏£‡∏¥‡∏´‡∏≤‡∏£‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏™‡∏π‡∏á, ‡∏ú‡∏π‡πâ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£, ‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô, ‡∏ú‡∏π‡πâ‡∏£‡∏±‡∏ö‡πÄ‡∏´‡∏°‡∏≤)
```prisma
model Position {
  id        Int      @id @default(autoincrement())
  name      String
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}
```

##### `WorkGroup`
‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏á‡∏≤‡∏ô (‡πÄ‡∏ä‡πà‡∏ô Operation, Maintenance, Engineering, Supporting)
```prisma
model WorkGroup {
  id        Int      @id @default(autoincrement())
  name      String
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}
```

#### 3. **Survey Content Models**

##### `Category`
‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏° (‡πÄ‡∏ä‡πà‡∏ô Leadership & Vision, Risk Management, Communication)
```prisma
model Category {
  id         Int         @id @default(autoincrement())
  name       String
  questions  Question[]
  createdAt  DateTime    @default(now())
  updatedAt  DateTime    @updatedAt
}
```

##### `Question`
‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡πÉ‡∏ô‡πÅ‡∏ö‡∏ö‡∏™‡∏≠‡∏ö‡∏ñ‡∏≤‡∏°
```prisma
model Question {
  id          Int        @id @default(autoincrement())
  text        String
  categoryId  Int
  category    Category   @relation(fields: [categoryId], references: [id])
  options     Option[]
  order       Int        @default(0)
  createdAt   DateTime   @default(now())
  updatedAt   DateTime   @updatedAt
  surveyAnswers SurveyAnswer[]
}
```

##### `Option`
‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö (1-5 rating scale)
```prisma
model Option {
  id          Int        @id @default(autoincrement())
  text        String
  questionId  Int
  question    Question   @relation(fields: [questionId], references: [id], onDelete: Cascade)
  createdAt   DateTime   @default(now())
  updatedAt   DateTime   @updatedAt
}
```

#### 4. **Survey Response Model**

##### `SurveyAnswer`
‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡∏Ç‡∏≠‡∏á‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏Ç‡πâ‡∏≠
```prisma
model SurveyAnswer {
  id                 Int      @id @default(autoincrement())
  userId             Int
  user               User     @relation(fields: [userId], references: [id])
  questionId         Int
  question           Question @relation(fields: [questionId], references: [id])
  currentScore       Int      // 1-5: ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏™‡∏ñ‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏ì‡πå‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô
  expectedScore      Int      // 1-5: ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏Ñ‡∏≤‡∏î‡∏´‡∏ß‡∏±‡∏á‡πÉ‡∏ô‡∏≠‡∏ô‡∏≤‡∏Ñ‡∏ï
  comment            String?  // ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏¥‡∏î‡πÄ‡∏´‡πá‡∏ô‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°
  createdAt          DateTime @default(now())
  updatedAt          DateTime @updatedAt

  @@unique([userId, questionId])  // User ‡∏ï‡∏≠‡∏ö‡πÑ‡∏î‡πâ‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡∏•‡∏∞ 1 ‡∏Ñ‡∏£‡∏±‡πâ‡∏á
}
```

### Entity Relationship Diagram

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê       ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê       ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  user_excel  ‚îÇ       ‚îÇ     User     ‚îÇ       ‚îÇ SurveyAnswer ‚îÇ
‚îÇ              ‚îÇ       ‚îÇ              ‚îÇ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñ∫‚îÇ              ‚îÇ
‚îÇ - email      ‚îÇ       ‚îÇ - email      ‚îÇ 1   M ‚îÇ - userId     ‚îÇ
‚îÇ - company    ‚îÇ       ‚îÇ - company    ‚îÇ       ‚îÇ - questionId ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò       ‚îÇ - status     ‚îÇ       ‚îÇ - current    ‚îÇ
                       ‚îÇ - surveyStatus       ‚îÇ - expected   ‚îÇ
                       ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò       ‚îÇ - comment    ‚îÇ
                                              ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                                                     ‚îÇ
                                                     ‚îÇ M
                       ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê       ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
                       ‚îÇ   Category   ‚îÇ       ‚îÇ   Question   ‚îÇ
                       ‚îÇ              ‚îÇ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñ∫‚îÇ              ‚îÇ
                       ‚îÇ - name       ‚îÇ 1   M ‚îÇ - text       ‚îÇ
                       ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò       ‚îÇ - order      ‚îÇ
                                              ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                                                     ‚îÇ
                                                     ‚îÇ 1
                                              ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
                                              ‚îÇ    Option    ‚îÇ
                                              ‚îÇ              ‚îÇ
                                              ‚îÇ - text       ‚îÇ
                                              ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

---

## API Endpoints

### üìÅ API Groups (13 ‡∏ä‡∏∏‡∏î)

#### 1. **Excel Upload** (`/excel-upload`)
```http
POST /excel-upload/upload
Content-Type: multipart/form-data

Body: file (Excel file)
```
**Logic:**
- ‡∏£‡∏±‡∏ö‡πÑ‡∏ü‡∏•‡πå Excel ‡∏ú‡πà‡∏≤‡∏ô multer middleware
- Parse ‡∏î‡πâ‡∏ß‡∏¢ ExcelJS (‡∏≠‡πà‡∏≤‡∏ô sheet ‡πÅ‡∏£‡∏Å, skip header row)
- Upsert ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏•‡∏á `user_excel` table (update ‡∏ñ‡πâ‡∏≤ email ‡∏ã‡πâ‡∏≥)

#### 2. **Company Management** (`/api/companies`)
```http
GET /api/companies                    # ‡∏î‡∏∂‡∏á‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î (distinct)
POST /api/companies                   # ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó‡πÉ‡∏´‡∏°‡πà
PUT /api/companies/:id                # ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó
DELETE /api/companies/:id             # ‡∏•‡∏ö‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó
```

#### 3. **Admin Authentication** (`/api/admin`)
```http
POST /api/admin/add                   # SuperAdmin ‡πÄ‡∏û‡∏¥‡πà‡∏° Admin ‡πÉ‡∏´‡∏°‡πà
GET /api/admin/list                   # ‡∏î‡∏∂‡∏á‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠ Admin ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
POST /api/admin/check-email           # ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö email ‡∏Å‡πà‡∏≠‡∏ô‡∏ï‡∏±‡πâ‡∏á‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô
PUT /api/admin/setup-account          # Admin ‡∏ï‡∏±‡πâ‡∏á‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡πÅ‡∏£‡∏Å
POST /api/admin/login                 # Admin login
POST /api/admin/verify-reset          # ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏ï‡∏±‡∏ß‡∏ï‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô
PUT /api/admin/reset-password         # ‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô
PUT /api/admin/update/:id             # ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• Admin
PUT /api/admin/status/:id             # ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ Admin (ACTIVE/PENDING)
DELETE /api/admin/delete/:id          # ‡∏•‡∏ö Admin
```

**Admin Authentication Logic:**
1. **Setup Flow:**
   - SuperAdmin ‡πÄ‡∏û‡∏¥‡πà‡∏° Admin ‡πÇ‡∏î‡∏¢‡∏£‡∏∞‡∏ö‡∏∏ `email` + `companyName`
   - ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô: `PENDING`
   - Admin ‡πÄ‡∏Ç‡πâ‡∏≤ `check-email` endpoint ‚Üí ‡∏ñ‡πâ‡∏≤‡∏û‡∏ö‡πÅ‡∏•‡∏∞ status = PENDING ‚Üí redirect ‡πÑ‡∏õ setup form
   - Admin ‡∏Å‡∏£‡∏≠‡∏Å `firstName`, `lastName`, `phone`, `password` ‚Üí ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å `setup-account`
   - ‡∏£‡∏∞‡∏ö‡∏ö hash password ‡∏î‡πâ‡∏ß‡∏¢ bcrypt (salt 10 rounds) ‚Üí ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÄ‡∏õ‡πá‡∏ô `ACTIVE`

2. **Login Flow:**
   - Admin ‡∏Å‡∏£‡∏≠‡∏Å `email` + `password`
   - ‡∏£‡∏∞‡∏ö‡∏ö‡∏´‡∏≤ admin ‡∏à‡∏≤‡∏Å email ‚Üí ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö `status === 'ACTIVE'`
   - ‡πÉ‡∏ä‡πâ `bcrypt.compare()` ‡πÄ‡∏õ‡∏£‡∏µ‡∏¢‡∏ö‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô
   - Return: `{ role: 'Admin', email, companyName }`

#### 4. **SuperAdmin Management** (`/api/super-admins`)
```http
GET /api/super-admins                 # ‡∏î‡∏∂‡∏á‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠ SuperAdmin ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
POST /api/super-admins                # ‡πÄ‡∏û‡∏¥‡πà‡∏° SuperAdmin ‡πÉ‡∏´‡∏°‡πà
POST /api/super-admins/check-email    # ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö email + status
POST /api/super-admins/setup          # ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏ö‡∏±‡∏ç‡∏ä‡∏µ‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡πÅ‡∏£‡∏Å (PIN + Password)
POST /api/super-admins/login          # Login
POST /api/super-admins/verify-for-reset   # ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏ï‡∏±‡∏ß‡∏ï‡∏ô‡∏î‡πâ‡∏ß‡∏¢ email + phone + PIN
POST /api/super-admins/reset-password     # ‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô
PUT /api/super-admins/:id             # ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
PUT /api/super-admins/status/:id      # ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞
DELETE /api/super-admins/:id          # ‡∏•‡∏ö SuperAdmin
```

**SuperAdmin Authentication Logic:**
1. **Setup Flow:**
   - ‡πÄ‡∏û‡∏¥‡πà‡∏° SuperAdmin ‡∏î‡πâ‡∏ß‡∏¢ `email` ‚Üí status = `PENDING`
   - Check email ‚Üí ‡∏ñ‡πâ‡∏≤‡∏û‡∏ö‡πÅ‡∏•‡∏∞ status = PENDING ‚Üí ‡πÅ‡∏™‡∏î‡∏á‡∏ü‡∏≠‡∏£‡πå‡∏° setup
   - ‡∏Å‡∏£‡∏≠‡∏Å `phone`, `pin` (6 ‡∏´‡∏•‡∏±‡∏Å), `password`
   - Hash ‡∏ó‡∏±‡πâ‡∏á PIN ‡πÅ‡∏•‡∏∞ Password ‡∏î‡πâ‡∏ß‡∏¢ bcrypt
   - ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÄ‡∏õ‡πá‡∏ô `ACTIVE`

2. **Login Flow:**
   - ‡∏Å‡∏£‡∏≠‡∏Å `email` + `password`
   - ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö `status === 'ACTIVE'`
   - bcrypt compare password
   - Update `lastLogin` timestamp
   - Return: `{ role: 'Super Admin' }`

#### 5. **User Management** (`/api/users`)
```http
GET /api/users                        # ‡∏î‡∏∂‡∏á‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
POST /api/users/check-email           # ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö email ‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö user_excel
POST /api/users/register              # ‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡πÉ‡∏´‡∏°‡πà
POST /api/users/login                 # User login
POST /api/users/forgot-password       # ‡∏Ç‡∏≠‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô
POST /api/users/reset-password        # ‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô
DELETE /api/users/by-email/:email     # ‡∏•‡∏ö User ‡∏î‡πâ‡∏ß‡∏¢ email
```

**User Registration & Login Logic:**
1. **Registration Flow:**
   - User ‡πÄ‡∏Ç‡πâ‡∏≤‡∏´‡∏ô‡πâ‡∏≤ Login Evaluator ‚Üí ‡∏Å‡∏£‡∏≠‡∏Å email
   - ‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏£‡∏µ‡∏¢‡∏Å `check-email` ‚Üí ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡πÉ‡∏ô `user_excel` table
   - ‡∏ñ‡πâ‡∏≤‡∏û‡∏ö ‚Üí redirect ‡πÑ‡∏õ‡∏´‡∏ô‡πâ‡∏≤ Registration form
   - User ‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•: `name`, `phone`, `position`, `department`, `workGroup`, `workExperience`, `password`
   - Hash password ‡∏î‡πâ‡∏ß‡∏¢ bcrypt
   - ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô `User` table ‡∏û‡∏£‡πâ‡∏≠‡∏°:
     - `status = 'registered'`
     - `surveyStatus = 'not_started'`
     - `role_user = 'user'`

2. **Login Flow:**
   - ‡∏Å‡∏£‡∏≠‡∏Å `email` + `password`
   - ‡∏´‡∏≤ user ‡∏à‡∏≤‡∏Å `email_user`
   - bcrypt compare password
   - Return: `{ role: 'user', name, email, surveyStatus }`

#### 6. **Assessment** (`/api/assessment`)
```http
GET /api/assessment                   # ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏û‡∏£‡πâ‡∏≠‡∏° options
POST /api/assessment/answer           # ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö
GET /api/assessment/answers/:userId   # ‡∏î‡∏∂‡∏á‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡∏Ç‡∏≠‡∏á user ‡∏ô‡∏µ‡πâ
GET /api/assessment/progress/:userId  # ‡∏î‡∏∂‡∏á‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡πÅ‡∏ö‡∏ö‡∏™‡∏≠‡∏ö‡∏ñ‡∏≤‡∏°
```

**Survey Submission Logic:**
```javascript
POST /api/assessment/answer
Body: {
  userId: int,
  questionId: int,
  currentScore: int (1-5),
  expectedScore: int (1-5),
  comment: string (optional)
}
```

**Algorithm:**
1. Validate input: `userId`, `questionId`, `currentScore`, `expectedScore` (1-5)
2. Upsert `SurveyAnswer`:
   - ‡∏ñ‡πâ‡∏≤‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏î‡∏¥‡∏° (userId + questionId) ‚Üí UPDATE
   - ‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏°‡∏µ ‚Üí CREATE
3. ‡∏ô‡∏±‡∏ö‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡∏ó‡∏µ‡πà‡∏ï‡∏≠‡∏ö‡πÅ‡∏•‡πâ‡∏ß vs ‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
4. Update `User.surveyStatus`:
   - ‡∏ñ‡πâ‡∏≤‡∏ï‡∏≠‡∏ö‡∏Ñ‡∏£‡∏ö‡∏ó‡∏∏‡∏Å‡∏Ç‡πâ‡∏≠ ‚Üí `done`
   - ‡∏ñ‡πâ‡∏≤‡∏ï‡∏≠‡∏ö‡πÅ‡∏•‡πâ‡∏ß‡∏ö‡∏≤‡∏á‡∏Ç‡πâ‡∏≠ ‚Üí `in_progress`
   - ‡∏ñ‡πâ‡∏≤‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏ï‡∏≠‡∏ö‡πÄ‡∏•‡∏¢ ‚Üí `not_started`
5. Return: saved answer + updated user status

**Auto-save Feature (Frontend):**
- ‡πÉ‡∏ä‡πâ `localStorage` ‡πÄ‡∏Å‡πá‡∏ö‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡∏ä‡∏±‡πà‡∏ß‡∏Ñ‡∏£‡∏≤‡∏ß
- Watch `answers` array ‚Üí debounce 1 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ ‚Üí save to localStorage
- ‡πÄ‡∏°‡∏∑‡πà‡∏≠ refresh ‡∏´‡∏ô‡πâ‡∏≤ ‚Üí restore ‡∏à‡∏≤‡∏Å localStorage
- ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏Å‡∏î Submit ‚Üí POST ‡∏ó‡∏∏‡∏Å‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡πÑ‡∏õ backend ‚Üí ‡∏•‡∏ö localStorage

#### 7. **Analytics** (`/api/analytics`)
```http
GET /api/analytics/survey-data       # ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏£‡∏≤‡∏ü‡πÅ‡∏¢‡∏Å‡∏ï‡∏≤‡∏°‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô 1-5
GET /api/analytics/aggregated        # ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏£‡∏ß‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î (avg scores)
GET /api/analytics/demographic       # ‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏ï‡∏≤‡∏°‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏Å‡∏£
GET /api/analytics/trend             # ‡πÅ‡∏ô‡∏ß‡πÇ‡∏ô‡πâ‡∏°‡∏ï‡∏≤‡∏°‡πÄ‡∏ß‡∏•‡∏≤ (‡∏£‡∏≤‡∏¢‡πÄ‡∏î‡∏∑‡∏≠‡∏ô)
GET /api/analytics/user-completion   # ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡πÅ‡∏ö‡∏ö‡∏™‡∏≠‡∏ö‡∏ñ‡∏≤‡∏°‡∏Ç‡∏≠‡∏á User
GET /api/analytics/stacked-chart     # ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Stacked Bar Chart
GET /api/analytics/companies         # ‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
GET /api/analytics/assessment-years  # ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏õ‡∏µ‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
GET /api/analytics/question-results  # ‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡πÅ‡∏¢‡∏Å‡∏ï‡∏≤‡∏°‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°
GET /api/analytics/workgroup-raw     # ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏î‡∏¥‡∏ö‡πÅ‡∏¢‡∏Å‡∏ï‡∏≤‡∏° WorkGroup
GET /api/analytics/workgroup-evaluation  # ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡πÅ‡∏¢‡∏Å‡∏ï‡∏≤‡∏° WorkGroup
GET /api/analytics/evaluation-data   # ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡πÅ‡∏ö‡∏ö General
```

**Analytics Algorithm Example: `getSurveyDataForChart`**
```javascript
// ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡πÅ‡∏¢‡∏Å‡∏ï‡∏≤‡∏°‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô 1-5 ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡πÄ‡∏â‡∏û‡∏≤‡∏∞
GET /api/analytics/survey-data?questionId=1&companyId=combined&year=2025

Algorithm:
1. Validate: questionId required
2. Build WHERE condition:
   - Filter by questionId
   - Filter by companyId (if not 'combined')
   - Filter by year (startOfYear to endOfYear)
3. Fetch SurveyAnswers ‡∏û‡∏£‡πâ‡∏≠‡∏° user.company_user
4. Initialize count arrays:
   - current = [0, 0, 0, 0, 0]  // ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô 1-5
   - future = [0, 0, 0, 0, 0]
5. Loop through answers:
   - ‡∏ô‡∏±‡∏ö currentScore ‚Üí current[score - 1]++
   - ‡∏ô‡∏±‡∏ö expectedScore ‚Üí future[score - 1]++
6. Return: {
     questionId,
     questionText,
     category: { id, name },
     companyId,
     current: [‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ñ‡∏ô score 1, 2, 3, 4, 5],
     future: [‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ñ‡∏ô score 1, 2, 3, 4, 5],
     totalResponses
   }
```

#### 8-11. **Master Data CRUD**
```http
# Department
GET /api/departments                  # ‡∏î‡∏∂‡∏á‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡πÅ‡∏ú‡∏ô‡∏Å‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
POST /api/departments                 # ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÅ‡∏ú‡∏ô‡∏Å‡πÉ‡∏´‡∏°‡πà
PUT /api/departments/:id              # ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÅ‡∏ú‡∏ô‡∏Å
DELETE /api/departments/:id           # ‡∏•‡∏ö‡πÅ‡∏ú‡∏ô‡∏Å

# Experience
GET /api/experiences                  # ‡∏î‡∏∂‡∏á‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡∏™‡∏ö‡∏Å‡∏≤‡∏£‡∏ì‡πå
POST /api/experiences                 # ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏õ‡∏£‡∏∞‡∏™‡∏ö‡∏Å‡∏≤‡∏£‡∏ì‡πå
PUT /api/experiences/:id              # ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç
DELETE /api/experiences/:id           # ‡∏•‡∏ö

# Position
GET /api/positions                    # ‡∏î‡∏∂‡∏á‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á
POST /api/positions                   # ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á
PUT /api/positions/:id                # ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç
DELETE /api/positions/:id             # ‡∏•‡∏ö

# WorkGroup
GET /api/workgroups                   # ‡∏î‡∏∂‡∏á‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏á‡∏≤‡∏ô
POST /api/workgroups                  # ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏á‡∏≤‡∏ô
PUT /api/workgroups/:id               # ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç
DELETE /api/workgroups/:id            # ‡∏•‡∏ö
```

#### 12. **Category & Question Management** (`/api/categories`, `/api/questions`)
```http
# Category
GET /api/categories                   # ‡∏î‡∏∂‡∏á‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î (‡∏û‡∏£‡πâ‡∏≠‡∏° questions)
POST /api/categories                  # ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà‡πÉ‡∏´‡∏°‡πà
PUT /api/categories/:id               # ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏ä‡∏∑‡πà‡∏≠‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà
DELETE /api/categories/:id            # ‡∏•‡∏ö‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà (cascade delete questions + options)

# Question
GET /api/questions                    # ‡∏î‡∏∂‡∏á‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î (‡∏û‡∏£‡πâ‡∏≠‡∏° options + comments)
POST /api/questions                   # ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡πÉ‡∏´‡∏°‡πà‡∏û‡∏£‡πâ‡∏≠‡∏° options
PUT /api/questions/:id                # ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏° + options
PUT /api/questions/:id/category       # ‡∏¢‡πâ‡∏≤‡∏¢‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡πÑ‡∏õ‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà‡∏≠‡∏∑‡πà‡∏ô
PUT /api/questions/reorder            # ‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡∏•‡∏≥‡∏î‡∏±‡∏ö‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°
DELETE /api/questions/:id             # ‡∏•‡∏ö‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏° (cascade delete options + answers)
```

**Question Ordering Logic:**
- ‡∏ó‡∏∏‡∏Å‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡∏°‡∏µ `order` field (global order, ‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà‡πÅ‡∏¢‡∏Å‡∏ï‡∏≤‡∏° category)
- ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡πÉ‡∏´‡∏°‡πà ‚Üí ‡∏´‡∏≤ max(order) + 1
- ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç order ‚Üí ‡∏ñ‡πâ‡∏≤ newOrder < oldOrder ‚Üí shift ‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡∏≠‡∏∑‡πà‡∏ô‡πÉ‡∏ô category ‡∏Ç‡∏∂‡πâ‡∏ô (+1)
- ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç order ‚Üí ‡∏ñ‡πâ‡∏≤ newOrder > oldOrder ‚Üí shift ‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡∏≠‡∏∑‡πà‡∏ô‡πÉ‡∏ô category ‡∏•‡∏á (-1)
- ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏¢‡πâ‡∏≤‡∏¢ category ‚Üí ‡πÄ‡∏Å‡πá‡∏ö order ‡πÄ‡∏î‡∏¥‡∏°‡πÑ‡∏ß‡πâ (‡πÑ‡∏°‡πà reorder)

---

## Business Logic

### 1. **User Registration Flow**
```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  User ‡πÄ‡∏Ç‡πâ‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡∏•‡πá‡∏≠‡∏Å‡∏≠‡∏¥‡∏ô ‚Üí ‡∏Å‡∏£‡∏≠‡∏Å email ‚Üí ‡∏Å‡∏î‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö                         ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                          ‚îÇ
                          ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  Backend: POST /api/users/check-email                              ‚îÇ
‚îÇ  - ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤ email ‡πÉ‡∏ô user_excel table                                 ‚îÇ
‚îÇ  - ‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏û‡∏ö (404) ‚Üí ‡πÅ‡∏™‡∏î‡∏á "‡∏≠‡∏µ‡πÄ‡∏°‡∏•‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå"                          ‚îÇ
‚îÇ  - ‡∏ñ‡πâ‡∏≤‡∏û‡∏ö‡πÅ‡∏•‡πâ‡∏ß register (409) ‚Üí redirect ‡πÑ‡∏õ‡∏´‡∏ô‡πâ‡∏≤ Login                ‚îÇ
‚îÇ  - ‡∏ñ‡πâ‡∏≤‡∏û‡∏ö‡πÅ‡∏ï‡πà‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà register (200) ‚Üí redirect ‡πÑ‡∏õ‡∏´‡∏ô‡πâ‡∏≤ Registration     ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                          ‚îÇ
                          ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  User ‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•: name, phone, position, department, etc.         ‚îÇ
‚îÇ  + ‡∏ï‡∏±‡πâ‡∏á‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô (‡∏ï‡πâ‡∏≠‡∏á‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö confirm password)                       ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                          ‚îÇ
                          ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  Backend: POST /api/users/register                                 ‚îÇ
‚îÇ  1. Hash password ‡∏î‡πâ‡∏ß‡∏¢ bcrypt (10 rounds)                         ‚îÇ
‚îÇ  2. Create User:                                                   ‚îÇ
‚îÇ     - status = 'registered'                                        ‚îÇ
‚îÇ     - surveyStatus = 'not_started'                                 ‚îÇ
‚îÇ     - role_user = 'user'                                           ‚îÇ
‚îÇ  3. Return user data                                               ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                          ‚îÇ
                          ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  Frontend: ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à ‚Üí redirect ‡πÑ‡∏õ‡∏´‡∏ô‡πâ‡∏≤ Login               ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### 2. **Survey Assessment Flow**
```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  User Login ‚Üí router.push('/assessment')                          ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                          ‚îÇ
                          ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  Frontend: GET /api/assessment                                     ‚îÇ
‚îÇ  - ‡∏î‡∏∂‡∏á categories + questions + options                           ‚îÇ
‚îÇ  - Flatten ‡πÄ‡∏õ‡πá‡∏ô array of questions                                ‚îÇ
‚îÇ  - Initialize answers array (length = questions.length)           ‚îÇ
‚îÇ  - Check localStorage ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö draft (key: `survey_draft_${userId}`)‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                          ‚îÇ
                          ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  User ‡∏ó‡∏≥‡πÅ‡∏ö‡∏ö‡∏™‡∏≠‡∏ö‡∏ñ‡∏≤‡∏°:                                                  ‚îÇ
‚îÇ  - ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å Radio button: currentScore (1-5)                          ‚îÇ
‚îÇ  - ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å Radio button: expectedScore (1-5)                         ‚îÇ
‚îÇ  - ‡∏û‡∏¥‡∏°‡∏û‡πå comment (optional)                                        ‚îÇ
‚îÇ  - ‡∏Å‡∏î Next ‚Üí currentIndex++                                        ‚îÇ
‚îÇ  - Auto-save ‡πÑ‡∏õ localStorage ‡∏ó‡∏∏‡∏Å 1 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ (debounce)              ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                          ‚îÇ
                          ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  User ‡∏Å‡∏î Submit ‡∏Ç‡πâ‡∏≠‡∏™‡∏∏‡∏î‡∏ó‡πâ‡∏≤‡∏¢:                                         ‚îÇ
‚îÇ  - Validate: ‡∏ó‡∏∏‡∏Å‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡∏ï‡πâ‡∏≠‡∏á‡∏°‡∏µ currentScore + expectedScore           ‚îÇ
‚îÇ  - Loop: POST /api/assessment/answer ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°             ‚îÇ
‚îÇ  - Backend: Upsert SurveyAnswer (unique: userId + questionId)     ‚îÇ
‚îÇ  - Backend: Update User.surveyStatus ‚Üí 'done'                     ‚îÇ
‚îÇ  - Frontend: ‡∏•‡∏ö localStorage ‚Üí ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à ‚Üí redirect /home  ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### 3. **Analytics Calculation**

#### Score Distribution Algorithm
```javascript
// ‡∏ô‡∏±‡∏ö‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ñ‡∏ô‡∏ó‡∏µ‡πà‡πÉ‡∏´‡πâ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏£‡∏∞‡∏î‡∏±‡∏ö (1-5)
function calculateScoreDistribution(surveyAnswers) {
  const current = [0, 0, 0, 0, 0];  // Index 0-4 = Score 1-5
  const future = [0, 0, 0, 0, 0];

  for (const answer of surveyAnswers) {
    if (answer.currentScore >= 1 && answer.currentScore <= 5) {
      current[answer.currentScore - 1]++;
    }
    if (answer.expectedScore >= 1 && answer.expectedScore <= 5) {
      future[answer.expectedScore - 1]++;
    }
  }

  return { current, future };
}
```

#### Stacked Bar Chart Data Preparation
```javascript
// ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Stacked Bar Chart: ‡πÅ‡∏™‡∏î‡∏á‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡∏ó‡∏∏‡∏Å‡∏Ç‡πâ‡∏≠‡πÅ‡∏¢‡∏Å‡∏ï‡∏≤‡∏°‡∏£‡∏∞‡∏î‡∏±‡∏ö 1-5
GET /api/analytics/stacked-chart?areaId=combined&year=2025

Algorithm:
1. Fetch categories + questions (ordered by question.order)
2. Build WHERE: questionIds, company filter, year filter
3. Fetch all SurveyAnswers
4. Initialize dataByQuestion = {
     questionId: { current: [0,0,0,0,0], future: [0,0,0,0,0] }
   }
5. Loop surveyAnswers ‚Üí ‡∏ô‡∏±‡∏ö‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏£‡∏∞‡∏î‡∏±‡∏ö
6. Prepare chart data:
   - labels = ["Q1: Category A", "Q2: Category A", "Q3: Category B", ...]
   - current = [
       [Q1-score1, Q2-score1, Q3-score1, ...],  // ‡∏Ñ‡∏ô score 1
       [Q1-score2, Q2-score2, Q3-score2, ...],  // ‡∏Ñ‡∏ô score 2
       ...
     ]
   - future = (same structure)
7. Return: { labels, current, future, areas, categories }
```

### 4. **Role-Based Access Control**

#### Route Guard (Frontend)
```javascript
// router/index.ts
router.beforeEach((to, from, next) => {
  const user = JSON.parse(localStorage.getItem('user') || '{}');
  const userRole = user.role;

  // Protected routes
  if (to.path === '/dashboard' && userRole !== 'Admin') {
    return next('/');  // Redirect to login
  }
  if (to.path === '/settings' && userRole !== 'Super Admin') {
    return next('/');
  }
  if (to.path === '/assessment' && userRole !== 'user') {
    return next('/');
  }

  next();
});
```

#### Authorization Matrix
| Route | User (Evaluator) | Admin | SuperAdmin |
|-------|:----------------:|:-----:|:----------:|
| `/` (Login Evaluator) | ‚úÖ | ‚ùå | ‚ùå |
| `/evaluator-registration` | ‚úÖ | ‚ùå | ‚ùå |
| `/Login-all` | ‚ùå | ‚úÖ | ‚úÖ |
| `/assessment` | ‚úÖ | ‚ùå | ‚ùå |
| `/home` | ‚úÖ | ‚ùå | ‚ùå |
| `/dashboard` | ‚ùå | ‚úÖ | ‚ùå |
| `/settings` | ‚ùå | ‚ùå | ‚úÖ |
| `/admin` | ‚ùå | ‚úÖ | ‚úÖ |
| `/superadmin` | ‚ùå | ‚ùå | ‚úÖ |

---

## Authentication & Authorization

### Password Hashing (bcrypt)
```javascript
const bcrypt = require('bcryptjs');

// Registration/Setup
const saltRounds = 10;
const hashedPassword = await bcrypt.hash(plainPassword, saltRounds);

// Login
const isMatch = await bcrypt.compare(plainPassword, hashedPassword);
```

### Session Storage
```javascript
// Frontend: localStorage (NO JWT)
localStorage.setItem('user', JSON.stringify({
  email: 'user@example.com',
  role: 'Admin',  // 'user', 'Admin', 'Super Admin'
  companyName: 'ACME Corp',
  firstName: 'John',
  lastName: 'Doe'
}));

// Access user data
const user = JSON.parse(localStorage.getItem('user') || '{}');
```

‚ö†Ô∏è **Security Note:** 
‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡∏Ñ‡∏ô‡∏µ‡πâ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πâ JWT ‡∏´‡∏£‡∏∑‡∏≠ Session-based authentication ‡∏ã‡∏∂‡πà‡∏á‡∏≠‡∏≤‡∏à‡∏°‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á‡∏î‡πâ‡∏≤‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢ (‡∏î‡∏π [Security Considerations](#security-considerations))

### SuperAdmin PIN System
- SuperAdmin ‡∏°‡∏µ 2-step authentication:
  1. **Setup**: email + phone + PIN (6 digits) + password
  2. **Login**: email + password
  3. **Password Reset**: email + phone + PIN (‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏ï‡∏±‡∏ß‡∏ï‡∏ô) ‚Üí ‡∏ï‡∏±‡πâ‡∏á‡∏£‡∏´‡∏±‡∏™‡πÉ‡∏´‡∏°‡πà

---

## Frontend Architecture

### Component Structure
```
src/
‚îÇ
‚îú‚îÄ‚îÄ components/
‚îÇ   ‚îú‚îÄ‚îÄ NavBar.vue                    # Top navigation (User side)
‚îÇ   ‚îú‚îÄ‚îÄ Footer.vue                    # Bottom footer
‚îÇ   ‚îî‚îÄ‚îÄ NavbarDashboard.vue           # Admin/SuperAdmin navigation
‚îÇ
‚îú‚îÄ‚îÄ views/
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ Login/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ LoginEvaluator/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ LoginEvaluator.vue           # User login form
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ EvaluatorRegistration.vue    # User registration
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ ForgotPasswordEvaluator.vue  # Password reset
‚îÇ   ‚îÇ   ‚îÇ
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ Administrator/
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ LoginAll.vue                 # Admin/SuperAdmin unified login
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ SetPasswordAdmin.vue         # Admin first-time setup
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ SetPasswordSuperAdmin.vue    # SuperAdmin first-time setup
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ Assessor/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ PageAssessment/
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ Assessment.vue               # Main survey form
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ data/
‚îÇ   ‚îÇ           ‚îî‚îÄ‚îÄ questions.js             # Static question data (unused?)
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ Dashboard/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ DashboardView.vue                # Admin dashboard home
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Users/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ UserList.vue                 # Users (Evaluators)
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ AdminList.vue                # Admin management
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ SuperAdmin/
‚îÇ   ‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ SuperAdminList.vue       # SuperAdmin management
‚îÇ   ‚îÇ   ‚îÇ
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Analytics/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ QuestionResults.vue          # Stacked bar chart
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ OpinionResults.vue           # Comment display
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ WorkGroupEvaluationResults.vue  # WorkGroup analysis
‚îÇ   ‚îÇ   ‚îÇ
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Showgraph/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ StackedBar.vue               # Stacked bar component
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ HorizontalBarChart.vue       # Horizontal bar component
‚îÇ   ‚îÇ   ‚îÇ
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ SettingsDashboard/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ SettingsView.vue             # SuperAdmin settings home
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ExcelUploadView.vue          # Upload user list
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ InquiryManagement.vue        # Contact form management
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ EditQuestions/
‚îÇ   ‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ EditQuestions.vue        # Question editor
‚îÇ   ‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ Questions.js             # Question data helper
‚îÇ   ‚îÇ   ‚îÇ
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ CompanyManagement.vue            # Company CRUD
‚îÇ   ‚îÇ
‚îÇ   ‚îî‚îÄ‚îÄ other/
‚îÇ       ‚îú‚îÄ‚îÄ Home.vue                         # User home page
‚îÇ       ‚îú‚îÄ‚îÄ AboutUs.vue                      # About page
‚îÇ       ‚îú‚îÄ‚îÄ Contact.vue                      # Contact form
‚îÇ       ‚îî‚îÄ‚îÄ NotFound.vue                     # 404 page
‚îÇ
‚îî‚îÄ‚îÄ router/
    ‚îî‚îÄ‚îÄ index.ts                             # Vue Router config
```

### Key Frontend Features

#### 1. **State Management**
```javascript
// Pinia Store (example)
import { defineStore } from 'pinia';

export const useUserStore = defineStore('user', {
  state: () => ({
    currentUser: null,
    isAuthenticated: false,
    surveyProgress: 0
  }),
  actions: {
    setUser(user) {
      this.currentUser = user;
      this.isAuthenticated = true;
    },
    logout() {
      this.currentUser = null;
      this.isAuthenticated = false;
      localStorage.removeItem('user');
    }
  }
});
```

#### 2. **Chart Integration (Chart.js)**
```vue
<!-- StackedBar.vue -->
<script setup>
import { defineProps, watch, ref, onMounted } from 'vue';
import { Bar } from 'vue-chartjs';
import {
  Chart as ChartJS,
  BarElement,
  CategoryScale,
  LinearScale,
  Title,
  Tooltip,
  Legend
} from 'chart.js';

ChartJS.register(BarElement, CategoryScale, LinearScale, Title, Tooltip, Legend);

const props = defineProps({
  chartData: Object,
  options: Object
});

// Chart configuration
const chartOptions = {
  responsive: true,
  maintainAspectRatio: false,
  scales: {
    x: { stacked: true },
    y: { stacked: true, beginAtZero: true }
  },
  plugins: {
    legend: { position: 'top' },
    title: { display: true, text: 'Survey Results' }
  }
};
</script>
```

#### 3. **API Service Layer**
```javascript
// services/api.js (example)
import axios from 'axios';

const apiClient = axios.create({
  baseURL: '/api',
  headers: {
    'Content-Type': 'application/json'
  }
});

// Interceptor ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö error handling
apiClient.interceptors.response.use(
  response => response,
  error => {
    if (error.response?.status === 401) {
      // Redirect to login
      localStorage.removeItem('user');
      window.location.href = '/';
    }
    return Promise.reject(error);
  }
);

export default {
  // Assessment
  getAssessmentData: () => apiClient.get('/assessment'),
  submitAnswer: (data) => apiClient.post('/assessment/answer', data),
  
  // Analytics
  getSurveyData: (params) => apiClient.get('/analytics/survey-data', { params }),
  getCompanies: () => apiClient.get('/companies'),
  
  // Auth
  loginUser: (credentials) => apiClient.post('/users/login', credentials),
  registerUser: (data) => apiClient.post('/users/register', data)
};
```

---

## Analytics & Reporting

### Dashboard Features

#### 1. **Question Results (Stacked Bar Chart)**
- ‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏ï‡∏≠‡∏ö‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡∏ó‡∏∏‡∏Å‡∏Ç‡πâ‡∏≠‡πÅ‡∏¢‡∏Å‡∏ï‡∏≤‡∏°‡∏£‡∏∞‡∏î‡∏±‡∏ö 1-5
- Filter by: Company, Position, Year
- Toggle: Compare (Current vs Future) / Current only / Future only
- Data source: `GET /api/analytics/stacked-chart`

#### 2. **Opinion Results**
- ‡πÅ‡∏™‡∏î‡∏á comments ‡∏à‡∏≤‡∏Å‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏ó‡∏∏‡∏Å‡∏Ñ‡∏ô (‡∏ó‡∏µ‡πà‡∏Å‡∏£‡∏≠‡∏Å comment)
- Group by: Question
- Data: `GET /api/questions` (include surveyAnswers.comment)

#### 3. **WorkGroup Evaluation**
- ‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÅ‡∏¢‡∏Å‡∏ï‡∏≤‡∏° WorkGroup (Operation, Maintenance, Engineering, Supporting)
- ‡πÅ‡∏™‡∏î‡∏á‡∏Ñ‡πà‡∏≤‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢ currentScore ‡πÅ‡∏•‡∏∞ expectedScore ‡∏Ç‡∏≠‡∏á‡πÅ‡∏ï‡πà‡∏•‡∏∞ category
- Radar chart ‡∏´‡∏£‡∏∑‡∏≠ Bar chart
- Data source: `GET /api/analytics/workgroup-evaluation`

#### 4. **User Completion Status**
- ‡πÅ‡∏™‡∏î‡∏á‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡πÅ‡∏ö‡∏ö‡∏™‡∏≠‡∏ö‡∏ñ‡∏≤‡∏°:
  - ‚úÖ `done`: ‡∏ó‡∏≥‡πÄ‡∏™‡∏£‡πá‡∏à‡πÅ‡∏•‡πâ‡∏ß
  - üîÑ `in_progress`: ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ó‡∏≥
  - ‚è∏Ô∏è `not_started`: ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ó‡∏≥
  - ‚ùå `not_registered`: ‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô user_excel ‡πÅ‡∏ï‡πà‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô
- Data source: `GET /api/analytics/user-completion`

### Chart Color Scheme
```javascript
// ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô 1-5 ‡πÉ‡∏ä‡πâ‡∏™‡∏µ‡πÅ‡∏¢‡∏Å‡∏ï‡∏≤‡∏° severity
const scoreColors = {
  1: '#ef4444',  // Red (‡πÑ‡∏°‡πà‡∏î‡∏µ)
  2: '#f97316',  // Orange (‡∏û‡∏≠‡πÉ‡∏ä‡πâ)
  3: '#eab308',  // Yellow (‡∏õ‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á)
  4: '#84cc16',  // Lime (‡∏î‡∏µ)
  5: '#22c55e'   // Green (‡∏î‡∏µ‡∏°‡∏≤‡∏Å)
};

// Current vs Future
const versionColors = {
  current: '#3b82f6',   // Blue
  future: '#8b5cf6'     // Purple
};
```

---

## ‡∏Å‡∏≤‡∏£‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á‡πÅ‡∏•‡∏∞‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô

### Prerequisites
- **Node.js** 20.x ‡∏´‡∏£‡∏∑‡∏≠‡πÉ‡∏´‡∏°‡πà‡∏Å‡∏ß‡πà‡∏≤
- **npm** 10.x ‡∏´‡∏£‡∏∑‡∏≠‡πÉ‡∏´‡∏°‡πà‡∏Å‡∏ß‡πà‡∏≤
- **MySQL** 8.0 ‡∏´‡∏£‡∏∑‡∏≠‡πÉ‡∏´‡∏°‡πà‡∏Å‡∏ß‡πà‡∏≤
- **Docker** + **Docker Compose** (optional, ‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥)

### 1. Clone Repository
```bash
git clone <repository-url>
cd Safety-Culture-Survey
```

### 2. Backend Setup
```bash
cd "Backend Safety-Culture-Survey"

# ‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á dependencies
npm install

# ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÑ‡∏ü‡∏•‡πå .env
cat > .env << EOF
DATABASE_URL="mysql://user:password@localhost:3307/survey_db"
PORT=5000
EOF

# Generate Prisma Client
npx prisma generate

# ‡∏£‡∏±‡∏ô migrations
npx prisma migrate deploy

# Seed ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• (SuperAdmin + ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á)
npx prisma db seed

# ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô development server
npm run dev
```

**Seed Data:**
- **SuperAdmin:**
  - Email: `superadmin@tunwa.com`
  - Password: `Admin@123`
  - PIN: `123456`

### 3. Frontend Setup
```bash
cd "Frontend Safety-Culture-Survey"

# ‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á dependencies
npm install

# ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô Vite dev server
npm run dev
```

‡πÄ‡∏õ‡∏¥‡∏î‡πÄ‡∏ö‡∏£‡∏≤‡∏ß‡πå‡πÄ‡∏ã‡∏≠‡∏£‡πå: `http://localhost:5173`

### 4. Database Setup (Manual)
```sql
-- ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
CREATE DATABASE survey_db CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;

-- ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö
USE survey_db;
SHOW TABLES;
```

---

## Docker Deployment

### Development Mode (Hot Reload)
```bash
# ‡πÉ‡∏ä‡πâ package.json scripts
npm run dev

# ‡∏´‡∏£‡∏∑‡∏≠‡πÉ‡∏ä‡πâ Makefile
make dev

# ‡∏´‡∏£‡∏∑‡∏≠‡πÉ‡∏ä‡πâ docker-compose ‡πÇ‡∏î‡∏¢‡∏ï‡∏£‡∏á
docker-compose -f docker-compose.dev.yml up --build
```

**Services:**
- **Frontend**: `http://localhost:5173` (Vite dev server + HMR)
- **Backend**: `http://localhost:5000` (nodemon auto-restart)
- **MySQL**: `localhost:3307`

**Hot Reload:**
- Frontend: Vite HMR (instant update)
- Backend: nodemon watches `server.js`, `controllers/*`, `routes/*`, `prisma/schema.prisma`

### Production Mode
```bash
# ‡πÉ‡∏ä‡πâ package.json scripts
npm run prod

# ‡∏´‡∏£‡∏∑‡∏≠‡πÉ‡∏ä‡πâ Makefile
make prod

# ‡∏´‡∏£‡∏∑‡∏≠‡πÉ‡∏ä‡πâ docker-compose ‡πÇ‡∏î‡∏¢‡∏ï‡∏£‡∏á
docker-compose up --build
```

**Services:**
- **Frontend**: `http://localhost` (Nginx serving static files)
- **Backend**: `http://localhost:5000` (Node.js production)
- **MySQL**: `localhost:3307`

**Nginx Configuration:**
```nginx
# frontend/nginx.conf
server {
  listen 80;
  server_name localhost;

  root /usr/share/nginx/html;
  index index.html;

  # SPA fallback
  location / {
    try_files $uri $uri/ /index.html;
  }

  # Proxy API requests to backend
  location /api/ {
    proxy_pass http://backend:5000/api/;
    proxy_http_version 1.1;
    proxy_set_header Upgrade $http_upgrade;
    proxy_set_header Connection 'upgrade';
    proxy_set_header Host $host;
    proxy_cache_bypass $http_upgrade;
  }
}
```

### Docker Management Commands
```bash
# Start services
npm run dev          # Development mode
npm run prod         # Production mode

# Stop services
npm run dev:down     # Stop dev containers
npm run prod:down    # Stop prod containers

# View logs
npm run dev:logs     # Dev logs
npm run prod:logs    # Prod logs

# Clean up
docker-compose down -v          # Remove containers + volumes
docker system prune -a --volumes  # Remove all unused Docker data
```

### Environment Variables
```env
# .env (Backend)
DATABASE_URL="mysql://root:rootpassword@mysql:3306/survey_db"
PORT=5000
NODE_ENV=production
```

---

## Security Considerations

### ‚ö†Ô∏è Current Security Issues

#### 1. **No JWT Authentication**
- ‡πÉ‡∏ä‡πâ localStorage ‡πÄ‡∏Å‡πá‡∏ö user data ‡πÇ‡∏î‡∏¢‡πÑ‡∏°‡πà‡∏°‡∏µ token
- ‡πÑ‡∏°‡πà‡∏°‡∏µ session expiration
- API endpoints ‡πÑ‡∏°‡πà‡∏°‡∏µ authentication middleware

**Recommendation:**
```javascript
// ‡∏Ñ‡∏ß‡∏£‡πÄ‡∏û‡∏¥‡πà‡∏° JWT
const jwt = require('jsonwebtoken');

// Login response
const token = jwt.sign(
  { userId: user.id, role: user.role },
  process.env.JWT_SECRET,
  { expiresIn: '24h' }
);

// Middleware
const authenticateToken = (req, res, next) => {
  const token = req.headers['authorization']?.split(' ')[1];
  if (!token) return res.sendStatus(401);
  
  jwt.verify(token, process.env.JWT_SECRET, (err, user) => {
    if (err) return res.sendStatus(403);
    req.user = user;
    next();
  });
};
```

#### 2. **CORS Configuration**
- ‡∏≠‡∏ô‡∏∏‡∏ç‡∏≤‡∏ï‡∏ó‡∏∏‡∏Å origin ‡πÉ‡∏ô development
- ‡∏Ñ‡∏ß‡∏£ whitelist specific domains ‡πÉ‡∏ô production

#### 3. **Input Validation**
- ‡πÑ‡∏°‡πà‡∏°‡∏µ validation middleware (‡πÄ‡∏ä‡πà‡∏ô Joi, express-validator)
- ‡∏Ñ‡∏ß‡∏£‡πÄ‡∏û‡∏¥‡πà‡∏° schema validation ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö request body

#### 4. **Rate Limiting**
- ‡πÑ‡∏°‡πà‡∏°‡∏µ rate limiting ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö login endpoints
- ‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á‡∏ï‡πà‡∏≠ brute force attacks

**Recommendation:**
```javascript
const rateLimit = require('express-rate-limit');

const loginLimiter = rateLimit({
  windowMs: 15 * 60 * 1000,  // 15 minutes
  max: 5,  // 5 requests
  message: 'Too many login attempts, please try again later.'
});

app.post('/api/users/login', loginLimiter, loginUser);
```

#### 5. **SQL Injection**
- Prisma ORM ‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô SQL injection ‡πÇ‡∏î‡∏¢‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥ ‚úÖ
- ‡πÅ‡∏ï‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏£‡∏∞‡∏ß‡∏±‡∏á‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ `$queryRaw` (‡∏Ñ‡∏ß‡∏£‡πÉ‡∏ä‡πâ parameterized queries)

#### 6. **Password Policy**
- ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏Ñ‡∏ß‡∏≤‡∏°‡πÅ‡∏Ç‡πá‡∏á‡πÅ‡∏£‡∏á‡∏Ç‡∏≠‡∏á‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô
- ‡∏Ñ‡∏ß‡∏£‡∏Å‡∏≥‡∏´‡∏ô‡∏î minimum length, complexity requirements

### ‚úÖ Security Best Practices (Implemented)
- ‚úÖ Password hashing ‡∏î‡πâ‡∏ß‡∏¢ bcrypt (salt rounds 10)
- ‚úÖ HTTPS-ready (nginx ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏û‡∏¥‡πà‡∏° SSL certificate ‡πÑ‡∏î‡πâ)
- ‚úÖ ‡πÉ‡∏ä‡πâ environment variables ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö sensitive data
- ‚úÖ Prisma ORM ‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô SQL injection
- ‚úÖ CORS configuration (multi-origin support)

---

## File Structure Summary

```
Safety-Culture-Survey/
‚îÇ
‚îú‚îÄ‚îÄ Backend Safety-Culture-Survey/
‚îÇ   ‚îú‚îÄ‚îÄ server.js                     # Express server entry point
‚îÇ   ‚îú‚îÄ‚îÄ package.json                  # Dependencies
‚îÇ   ‚îú‚îÄ‚îÄ .env                          # Environment variables (gitignored)
‚îÇ   ‚îú‚îÄ‚îÄ .env.example                  # Template for .env
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ controllers/                  # Business logic
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Admin/
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ adminAuthController.js
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ SuperAdmin/
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ superAdminController.js
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ User/
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ userController.js
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Assessment/
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ assessmentController.js
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Analytics/
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ analyticsController.js
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Category/
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ categoryController.js
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Questions/
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ questionController.js
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Department/
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ departmentController.js
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Experience/
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ experienceController.js
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Position/
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ positionController.js
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Workgroup/
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ workGroupController.js
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ Company/
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ companyController.js
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ routes/                       # Route definitions
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ index.js                  # Central route registrar
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Admin/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ SuperAdmin/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ User/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Assessment/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Analytics/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Category/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Questions/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Department/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Experience/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Position/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Workgroup/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Company/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ UploadExcel/
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ prisma/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ schema.prisma             # Database schema
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ seed.js                   # Database seeding
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ migrations/               # Migration history
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ index.js                  # Unused (kept for compatibility)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ prisma.js                 # Prisma client instance
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ UploadExcel/
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ excelUpload.js        # Excel upload logic
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ Dockerfile                    # Backend container
‚îÇ   ‚îî‚îÄ‚îÄ nodemon.json                  # Nodemon config (dev mode)
‚îÇ
‚îú‚îÄ‚îÄ Frontend Safety-Culture-Survey/
‚îÇ   ‚îú‚îÄ‚îÄ index.html                    # Entry HTML
‚îÇ   ‚îú‚îÄ‚îÄ package.json                  # Dependencies
‚îÇ   ‚îú‚îÄ‚îÄ vite.config.ts                # Vite config
‚îÇ   ‚îú‚îÄ‚îÄ tsconfig.json                 # TypeScript config
‚îÇ   ‚îú‚îÄ‚îÄ tailwind.config.js            # Tailwind config
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ App.vue                   # Root component
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ main.ts                   # Vue app entry
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ style.css                 # Global styles
‚îÇ   ‚îÇ   ‚îÇ
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ components/               # Reusable components
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ views/                    # Page components
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ router/                   # Vue Router
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ assets/                   # Static assets
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ Dockerfile                    # Frontend container (multi-stage)
‚îÇ   ‚îú‚îÄ‚îÄ nginx.conf                    # Nginx config (production)
‚îÇ   ‚îî‚îÄ‚îÄ public/                       # Public assets
‚îÇ
‚îú‚îÄ‚îÄ docker-compose.yml                # Production Docker setup
‚îú‚îÄ‚îÄ docker-compose.dev.yml            # Development Docker setup
‚îú‚îÄ‚îÄ package.json                      # Root scripts (docker shortcuts)
‚îú‚îÄ‚îÄ Makefile                          # Make commands
‚îÇ
‚îú‚îÄ‚îÄ README.md                         # This file
‚îú‚îÄ‚îÄ API_DOCUMENTATION.md              # API detailed docs
‚îú‚îÄ‚îÄ SETUP_GUIDE.md                    # Setup instructions
‚îî‚îÄ‚îÄ Postman_API_Collection.json       # Postman collection
```

---

## Development Workflow

### 1. **Local Development (Without Docker)**
```bash
# Terminal 1: Backend
cd "Backend Safety-Culture-Survey"
npm run dev

# Terminal 2: Frontend
cd "Frontend Safety-Culture-Survey"
npm run dev

# Terminal 3: MySQL (‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà Docker)
mysql -u root -p
```

### 2. **Docker Development**
```bash
# ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏Å‡∏±‡∏ô
npm run dev

# ‡∏î‡∏π logs ‡πÅ‡∏ö‡∏ö real-time
npm run dev:logs

# Restart service ‡πÄ‡∏â‡∏û‡∏≤‡∏∞
docker-compose -f docker-compose.dev.yml restart backend
docker-compose -f docker-compose.dev.yml restart frontend
```

### 3. **Database Operations**
```bash
# ‡∏™‡∏£‡πâ‡∏≤‡∏á migration ‡πÉ‡∏´‡∏°‡πà
cd "Backend Safety-Culture-Survey"
npx prisma migrate dev --name add_new_field

# Reset database (‡∏•‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î + seed ‡πÉ‡∏´‡∏°‡πà)
npx prisma migrate reset

# Open Prisma Studio (GUI)
npx prisma studio
```

### 4. **Code Style & Linting**
```bash
# Frontend
cd "Frontend Safety-Culture-Survey"
npm run lint
npm run type-check

# Backend
cd "Backend Safety-Culture-Survey"
npm run lint  # (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ ESLint config)
```

---

## Testing

### Manual Testing Checklist

#### User Flow
- [ ] ‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡πÉ‡∏´‡∏°‡πà (email ‡∏ï‡πâ‡∏≠‡∏á‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô user_excel)
- [ ] Login ‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ
- [ ] ‡∏ó‡∏≥‡πÅ‡∏ö‡∏ö‡∏™‡∏≠‡∏ö‡∏ñ‡∏≤‡∏° (‡πÄ‡∏•‡∏∑‡∏≠‡∏Å current + expected score)
- [ ] ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å draft ‡∏•‡∏á localStorage
- [ ] Submit ‡πÅ‡∏ö‡∏ö‡∏™‡∏≠‡∏ö‡∏ñ‡∏≤‡∏°
- [ ] ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö surveyStatus ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÄ‡∏õ‡πá‡∏ô 'done'

#### Admin Flow
- [ ] SuperAdmin ‡πÄ‡∏û‡∏¥‡πà‡∏° Admin (email + companyName)
- [ ] Admin ‡∏ï‡∏±‡πâ‡∏á‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡πÅ‡∏£‡∏Å (setup account)
- [ ] Admin login
- [ ] ‡∏î‡∏π Dashboard (UserList, Analytics)
- [ ] Export ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ feature)

#### SuperAdmin Flow
- [ ] ‡πÄ‡∏û‡∏¥‡πà‡∏° SuperAdmin ‡πÉ‡∏´‡∏°‡πà
- [ ] Setup account (PIN + password)
- [ ] Login
- [ ] Upload Excel (user list)
- [ ] ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£ Categories/Questions
- [ ] ‡∏î‡∏π Analytics ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î

#### Analytics
- [ ] ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å Company filter ‚Üí ‡∏î‡∏π‡∏Å‡∏£‡∏≤‡∏ü‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô
- [ ] ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å Position filter ‚Üí ‡∏î‡∏π‡∏Å‡∏£‡∏≤‡∏ü‡πÅ‡∏¢‡∏Å‡∏ï‡∏≤‡∏°‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á
- [ ] Toggle Current/Future/Compare ‚Üí ‡∏Å‡∏£‡∏≤‡∏ü‡πÅ‡∏™‡∏î‡∏á‡∏ï‡∏≤‡∏°‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å
- [ ] ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏õ‡∏µ ‚Üí ‡∏î‡∏π‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏¢‡πâ‡∏≠‡∏ô‡∏´‡∏•‡∏±‡∏á

---

## API Testing

### Postman Collection
‡∏î‡∏π‡πÑ‡∏ü‡∏•‡πå `Postman_API_Collection.json` ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö API endpoints ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î

### Example cURL Commands
```bash
# Check user email
curl -X POST http://localhost:5000/api/users/check-email \
  -H "Content-Type: application/json" \
  -d '{"email": "user@example.com"}'

# Register user
curl -X POST http://localhost:5000/api/users/register \
  -H "Content-Type: application/json" \
  -d '{
    "name": "John Doe",
    "email": "user@example.com",
    "phone": "0812345678",
    "password": "SecurePass123",
    "company": "ACME Corp",
    "position": "Engineer",
    "department": "Engineering",
    "workGroup": "Operation",
    "workExperience": "3-5 ‡∏õ‡∏µ"
  }'

# Submit survey answer
curl -X POST http://localhost:5000/api/assessment/answer \
  -H "Content-Type: application/json" \
  -d '{
    "userId": 1,
    "questionId": 1,
    "currentScore": 3,
    "expectedScore": 5,
    "comment": "‡∏Ñ‡∏ß‡∏£‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡∏∑‡πà‡∏≠‡∏™‡∏≤‡∏£"
  }'

# Get survey data
curl "http://localhost:5000/api/analytics/survey-data?questionId=1&companyId=combined&year=2025"
```

---

## Troubleshooting

### Common Issues

#### 1. **Port Already in Use**
```bash
# Windows
netstat -ano | findstr :5000
taskkill /PID <PID> /F

# Linux/Mac
lsof -ti:5000 | xargs kill -9
```

#### 2. **Docker Build Fails**
```bash
# ‡∏•‡∏ö cache ‡πÅ‡∏•‡∏∞ rebuild
docker-compose down -v
docker system prune -a
docker-compose up --build --force-recreate
```

#### 3. **Prisma Client Out of Sync**
```bash
npx prisma generate
npx prisma migrate deploy
```

#### 4. **Frontend CORS Error**
- ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö `server.js` ‚Üí `allowedOrigins` array
- ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö `vite.config.ts` ‚Üí proxy configuration

#### 5. **MySQL Connection Error**
```bash
# ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö MySQL container
docker ps
docker logs survey-tunwa-mysql-1

# Test connection
mysql -h localhost -P 3307 -u root -p
```

---

## Performance Optimization

### Backend
- ‡πÉ‡∏ä‡πâ Prisma `select` ‡πÄ‡∏â‡∏û‡∏≤‡∏∞ fields ‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£
- ‡πÉ‡∏ä‡πâ `include` ‡πÅ‡∏ó‡∏ô multiple queries
- Enable query caching (Redis - ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà implement)
- Paginate API responses for large datasets

### Frontend
- Code splitting ‡∏î‡πâ‡∏ß‡∏¢ Vue Router lazy loading
- Image optimization (WebP format)
- Compress static assets (Vite build)
- Use virtual scrolling for long lists

### Database
- Add indexes ‡∏ö‡∏ô frequently queried columns:
  ```sql
  CREATE INDEX idx_user_email ON User(email_user);
  CREATE INDEX idx_survey_user_question ON SurveyAnswer(userId, questionId);
  CREATE INDEX idx_survey_created ON SurveyAnswer(createdAt);
  ```

---

## Future Enhancements

### Phase 1: Security
- [ ] Implement JWT authentication
- [ ] Add rate limiting
- [ ] Input validation middleware (Joi)
- [ ] Password strength requirements
- [ ] Two-factor authentication (2FA)

### Phase 2: Features
- [ ] Email notifications (assessment reminders)
- [ ] PDF report generation
- [ ] Data export (CSV, Excel)
- [ ] Advanced analytics (Machine Learning insights)
- [ ] Multi-language support (i18n)

### Phase 3: DevOps
- [ ] CI/CD pipeline (GitHub Actions)
- [ ] Automated testing (Jest, Playwright)
- [ ] Error tracking (Sentry)
- [ ] Logging system (Winston, ELK Stack)
- [ ] Kubernetes deployment

### Phase 4: UX/UI
- [ ] Dark mode
- [ ] Progressive Web App (PWA)
- [ ] Mobile responsive improvements
- [ ] Accessibility (WCAG compliance)

---

## Contributing

### Git Workflow
```bash
# ‡∏™‡∏£‡πâ‡∏≤‡∏á feature branch
git checkout -b feature/new-feature

# Commit messages
git commit -m "feat: add JWT authentication"
git commit -m "fix: resolve CORS issue on production"
git commit -m "docs: update API documentation"

# Push and create PR
git push origin feature/new-feature
```

### Commit Message Convention
```
feat: ‡∏ü‡∏µ‡πÄ‡∏à‡∏≠‡∏£‡πå‡πÉ‡∏´‡∏°‡πà
fix: ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç bug
docs: ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£
style: ‡∏à‡∏±‡∏î‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡πÇ‡∏Ñ‡πâ‡∏î (‡πÑ‡∏°‡πà‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô logic)
refactor: ‡∏õ‡∏£‡∏±‡∏ö‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÇ‡∏Ñ‡πâ‡∏î
test: ‡πÄ‡∏û‡∏¥‡πà‡∏°/‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç tests
chore: ‡∏á‡∏≤‡∏ô‡∏≠‡∏∑‡πà‡∏ô‡πÜ (update dependencies, config)
```

---

## License

MIT License (‡∏´‡∏£‡∏∑‡∏≠ license ‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£)

---

## Contact & Support

- **Email**: support@example.com
- **GitHub Issues**: [Link to GitHub Issues]
- **Documentation**: [Link to detailed docs]

---

## Credits

**Developed by:** [Your Team/Organization]  
**Tech Stack:** Node.js, Express, Vue 3, Prisma, MySQL, Docker, Tailwind CSS  
**Chart Library:** Chart.js  
**Icon Library:** Heroicons (SVG)

---

## Changelog

### Version 1.0.0 (2025-01-XX)
- ‚ú® Initial release
- ‚úÖ Complete authentication system (User/Admin/SuperAdmin)
- ‚úÖ Survey assessment with auto-save
- ‚úÖ Analytics dashboard with charts
- ‚úÖ Docker support (dev + prod)
- ‚úÖ Excel import for user list
- ‚úÖ Master data management
- ‚úÖ Responsive design (Tailwind CSS)

---

**Last Updated:** 2025-01-12  
**README Version:** 1.0.0
