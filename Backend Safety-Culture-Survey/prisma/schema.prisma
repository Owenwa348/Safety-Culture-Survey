// This is your Prisma schema file
// Define your data models here

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

model user_excel {
  id             Int      @id @default(autoincrement())
  email_user     String   @unique
  company_user   String
  division_user  String?
  createdAt      DateTime @default(now())
}

// Add the User model for registered users
model User {
  id                Int      @id @default(autoincrement())
  title_user        String?  // Added title field
  name_user         String
  email_user        String   @unique
  company_user      String
  phone_user        String?
  password_user     String?
  position_user     String?
  job_field_user    String?  // This corresponds to department in the frontend
  work_group_user   String?  // This corresponds to workGroup in the frontend
  years_of_service  String?  // This corresponds to workExperience in the frontend
  section_user      String?  // This corresponds to division in the frontend
  role_user         String   @default("user")
  status            String   @default("registered") // registered, active, inactive
  surveyStatus      String   @default("not_started") // not_started, in_progress, done
  createdAt         DateTime @default(now())
  updatedAt         DateTime @updatedAt
  surveyAnswers     SurveyAnswer[]
}

model AdminList {
  id          Int       @id @default(autoincrement())
  email       String    @unique
  companyName String
  firstName   String?
  lastName    String?
  phone       String?
  password    String?
  role        String    @default("Admin")
  status      String    @default("PENDING") // PENDING = ยังไม่ยืนยันตัวตน, ACTIVE = ยืนยันตัวตนแล้ว
  joinedAt    DateTime?

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

// ตาราง Department - สายงาน
model Department {
  id            Int      @id @default(autoincrement())
  name          String   // ชื่อสายงาน เช่น CEO, REP, COO, CFO, SSE, PSE, CME
  createdAt     DateTime @default(now())
  updatedAt     DateTime @updatedAt

}

// ตาราง Experience - ประสบการณ์การทำงาน
model Experience {
  id            Int      @id @default(autoincrement())
  name          String   // ช่วงประสบการณ์ เช่น 0-3 ปี, 3 ปีขึ้นไป แต่ไม่เกิน 5 ปี , 5 ปีขึ้นไป แต่ไม่เกิน 10 ปี , 10 ปีขึ้นไป แต่ไม่เกิน 15 ปี , มากกว่า 15 ปีขึ้นไป
  createdAt     DateTime @default(now())
  updatedAt     DateTime @updatedAt

}

// ตาราง Position - ตำแหน่งงาน
model Position {
  id            Int      @id @default(autoincrement())
  name          String   // ชื่อตำแหน่ง เช่น ผู้บริหารระดับสูง / ผู้จัดการส่วน , ผู้จัดการแผนก / ผู้จัดการ / พนักงานอาวุโส , พนักงาน , ผู้รับเหมาประจำ
  createdAt     DateTime @default(now())
  updatedAt     DateTime @updatedAt

}

// ตาราง WorkGroup - กลุ่มงาน
model WorkGroup {
  id            Int      @id @default(autoincrement())
  name          String   // ชื่อกลุ่มงาน เช่น หน่วยงานเดินเครื่อง (Operation), หน่วยงานบำรุงรักษา (Maintenance) , หน่วยงานวิศวกรรม (Engineering) ,หน่วยงานสนับสนุน (Supporting functions)
  createdAt     DateTime @default(now())
  updatedAt     DateTime @updatedAt

}

model Category {
  id         Int         @id @default(autoincrement())
  name       String
  questions  Question[]
  createdAt  DateTime    @default(now())
  updatedAt  DateTime    @updatedAt
}

model Question {
  id          Int        @id @default(autoincrement())
  text        String
  categoryId  Int
  category    Category   @relation(fields: [categoryId], references: [id])
  options     Option[]
  order       Int        @default(0)  // Add order field for question sequencing
  createdAt   DateTime   @default(now())
  updatedAt   DateTime   @updatedAt
  surveyAnswers SurveyAnswer[]
}

model Option {
  id          Int        @id @default(autoincrement())
  text        String
  questionId  Int
  question    Question   @relation(fields: [questionId], references: [id], onDelete: Cascade)
  createdAt   DateTime   @default(now())
  updatedAt   DateTime   @updatedAt
}

model SuperAdminList {
  id        Int       @id @default(autoincrement())
  email     String    @unique
  phone     String?   @unique
  pin       String?
  password  String?
  role      String    @default("Super Admin")
  status    String    @default("PENDING") // PENDING = ยังไม่ยืนยันตัวตน, ACTIVE = ยืนยันตัวตนแล้ว
  lastLogin DateTime?
  createdAt DateTime  @default(now())
  updatedAt DateTime  @updatedAt
}

// Model for storing survey answers
model SurveyAnswer {
  id                 Int      @id @default(autoincrement())
  userId             Int
  user               User     @relation(fields: [userId], references: [id])
  questionId         Int
  question           Question @relation(fields: [questionId], references: [id])
  currentScore       Int      // 1-5 score for current situation
  expectedScore      Int      // 1-5 score for expected future situation
  comment            String?  // Additional comments
  createdAt          DateTime @default(now())
  updatedAt          DateTime @updatedAt

  @@unique([userId, questionId]) // Ensure one answer per user per question
}

// Model for storing inquiries from assessors
model Inquiry {
  id          Int      @id @default(autoincrement())
  name        String   // ชื่อ - นามสกุลของผู้ส่งติดต่อสอบถาม
  email       String   // อีเมลของผู้ส่งติดต่อสอบถาม
  phone       String   // เบอร์โทรศัพท์ของผู้ส่งติดต่อสอบถาม
  message     String   @db.LongText // ข้อความที่ส่งมา
  status      String   @default("UNREAD") // UNREAD = ยังไม่ได้อ่าน, READ = อ่านแล้ว, RESOLVED = แก้ไขเรียบร้อย
  reply       String?  @db.LongText // การตอบกลับจาก SuperAdmin
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
  readAt      DateTime? // วันที่ที่ SuperAdmin อ่านข้อมูล
}